name: auto-weekday-deploy

on: push

jobs:
  auto-weekday-deploy:
    name: 'Auto Build & Deploy'
    runs-on: ubuntu-latest

    strategy:
      matrix:
        include:
          - region: kor
            s3Path: s3://kakaowebtoon-web-dev/kor
            domain: co.kr

    steps:
      - uses: actions/checkout@v2

      - name: sdafadsfasdf
        run: |
          curl \
            -X POST \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/repos/${GITHUB_REPOSITORY}/actions/runs/${GITHUB_RUN_ID}/cancel

      - name: Send slack if completed
        if: ${{ success() }}
        uses: ./.github/actions/slack-notify
        with:
          region: ${{ matrix.region }}
          env: dev
          status: success
          domain: ${{ matrix.domain }}

      - name: Send slack if completed
        if: ${{ failure() }}
        uses: ./.github/actions/slack-notify
        with:
          region: ${{ matrix.region }}
          env: dev
          status: success
          domain: ${{ matrix.domain }}
